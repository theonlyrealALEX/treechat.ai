<html>

<head>
    <title>treechat.ai</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/botui/build/botui.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/botui/build/botui-theme-default.css" />
</head>

<body>
    <div class="botui-app-containerx" id="Tree">
        <bot-ui></bot-ui>
    </div>
    <script src="https://cdn.jsdelivr.net/vue/latest/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/botui/build/botui.js"></script>
    <script>
        var botui = new BotUI('Tree');
        var chat_history = new String("")
        var cnt = 0

        //START: Test Code for API
        const data = { message: "hey" };
        fetch('http://localhost:3000/input', body = JSON.stringify(data))
            .then(response => response.json())
            .then(data => {
                // Use the data here
            })
            .catch(error => console.error(error));

        //END: Test Code for API

        function sendMessage() {
            botui.action.text({
                action: {
                    placeholder: 'Enter your Question'
                }
            }).then(function (input) {
                var botResponse = input.value // call backend

                botui.message.add({
                    human: false,
                    content: botResponse
                }).then(function () {
                    if (cnt < 10) {
                        sendMessage();
                        cnt += 1
                    } else {
                        botui.message.add({
                            content: "Thanks for using TreeChat.ai"
                        })
                    }
                })
            });
        }

        botui.message.add({
            content: "Welcome to TreeChat.ai"
        }).then(sendMessage())

    </script>
</body>

</html>